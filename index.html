<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NFA Visualizer</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <h1>NFA Visualizer</h1>

  <div class="container">
    <div class="description">
      <p>
        Define a finite-state machine using JavaScript. The FSM processes an ordered
        sequence of values and determines validity based on whether it reaches an accept state.
      </p>
      <p class="tip">
        Tip: Use <code>console.log()</code> in your functions for debugging.
      </p>
    </div>

    <div class="input-header">
      <div class="name-field">
        <label for="fsm-name">Name:</label>
        <input type="text" id="fsm-name" maxlength="20" placeholder="optional">
      </div>
      <label class="toggle-label">
        <input type="checkbox" id="unified-toggle">
        <span>Unified input</span>
      </label>
    </div>

    <div id="split-input" class="input-section">
      <div class="code-block">
        <div class="code-comment">// Initial state(s). Use an array for multiple start states.</div>
        <div class="code-line">
          <span class="code-prefix">startState = </span>
          <textarea id="start-state" rows="1" spellcheck="false" placeholder='"start"'>0</textarea>
          <span class="code-suffix">;</span>
        </div>
      </div>

      <div class="code-block">
        <div class="code-comment">// Returns next state(s) given current state and input value.</div>
        <div class="code-comment">// Return undefined or [] for no transition (dead end).</div>
        <div class="code-line">
          <span class="code-prefix">function transition(state, value) {</span>
        </div>
        <textarea id="transition-fn" rows="10" spellcheck="false" placeholder='return "next";'>// Count: accepts sequences summing to 3
if (state + value <= 3) {
  return state + value;
}
return undefined;</textarea>
        <div class="code-line">
          <span class="code-suffix">}</span>
        </div>
      </div>

      <div class="code-block">
        <div class="code-comment">// Returns true if state is a valid final/accepting state.</div>
        <div class="code-line">
          <span class="code-prefix">function accept(state) {</span>
        </div>
        <textarea id="accept-fn" rows="2" spellcheck="false"
          placeholder='return state === "done";'>return state === 3;</textarea>
        <div class="code-line">
          <span class="code-suffix">}</span>
        </div>
      </div>
    </div>

    <div id="unified-input" class="input-section hidden">
      <textarea id="unified-code" rows="18" spellcheck="false" placeholder='startState = "start";

function transition(state, value) {
  return "next";
}

function accept(state) {
  return state === "done";
}'></textarea>
    </div>

    <div id="error-display" class="error-display hidden"></div>

    <div class="button-row">
      <button id="build-btn" class="primary-btn">Build NFA</button>
    </div>

    <div id="test-section" class="test-section hidden">
      <h2>Test Input</h2>
      <div class="test-input-row">
        <label for="test-input">Input sequence (comma-separated):</label>
        <input type="text" id="test-input" placeholder="1, 2, 3" value="1, 2">
        <button id="test-btn">Test</button>
      </div>
      <div id="test-result" class="test-result"></div>
    </div>

    <div id="visualization-section" class="visualization-section hidden">
      <h2>NFA Visualization</h2>
      <div class="viz-controls">
        <span id="state-count"></span>
      </div>
      <div id="nfa-canvas-container">
        <canvas id="nfa-canvas"></canvas>
      </div>
    </div>
  </div>

  <script type="module" src="js/app.js"></script>
</body>

</html>